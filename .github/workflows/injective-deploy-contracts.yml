# .github/workflows/injective-deploy-contracts.yml

name: Injective Daily Contract Deployment

on:
  schedule:
    # هر 30 دقیقه یک بار اجرا شود
    - cron: '*/30 * * * *' 
  workflow_dispatch: # برای اجرای دستی

jobs:
  deploy-contracts:
    runs-on: ubuntu-latest
    
    env:
      INJECTIVE_PRIVATE_KEY: ${{ secrets.INJECTIVE_PRIVATE_KEY }}

    steps:
      - name: ⬇️ Checkout Repository
        uses: actions/checkout@v4
        
      - name: 🛠️ Setup Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.9' # تغییر به پایتون 3.9 (pysolcx با 3.9 بهتر کار می‌کند)

      - name: 📦 Install Python Dependencies
        # این مرحله pysolcx و بقیه وابستگی‌ها رو نصب می‌کنه
        run: pip install -r requirements.txt 

      # **مهم:** نصب OpenZeppelin Contracts برای کامپایل MyNFT.sol
      # این مرحله برای اینکه کامپایلر Solidity بتونه @openzeppelin/contracts رو پیدا کنه، ضروریه.
      - name: 📦 Install OpenZeppelin Contracts (for Solidity imports)
        run: |
          npm install @openzeppelin/contracts 
        working-directory: ${{ github.workspace }} # در ریشه ریپازیتوری نصب شود

      - name: 🚀 Run Contract Deployment Script
        run: python scripts/deploy_contracts.py
