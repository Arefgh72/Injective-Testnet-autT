# .github/workflows/injective-deploy-contracts.yml

name: Injective Daily Contract Deployment

on:
  schedule:
    - cron: '*/30 * * * *' 
  workflow_dispatch:

jobs:
  deploy-contracts:
    runs-on: ubuntu-latest
    
    env:
      INJECTIVE_PRIVATE_KEY: ${{ secrets.INJECTIVE_PRIVATE_KEY }}

    steps:
      - name: ⬇️ Checkout Repository
        uses: actions/checkout@v4
        
      - name: 🛠️ Setup Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.9' # تغییر به پایتون 3.9 (نسخه‌ای که solcx بهتر باهاش کار می‌کنه)

      - name: 📦 Install Python Dependencies
        run: pip install -r requirements.txt # web3.py, pytz, python-dotenv نصب میشن

      - name: 🔧 Install solcx
        run: pip install solcx # solcx رو به صورت مستقل نصب می‌کنیم (ورژن جدید خودش رو پیدا می‌کنه)

      # نصب OpenZeppelin Contracts (برای Solidity imports) - این مرحله سرجاش می‌مونه
      - name: 📦 Install OpenZeppelin Contracts (for Solidity imports)
        run: |
          npm install @openzeppelin/contracts 

      - name: 🚀 Run Contract Deployment Script
        run: python scripts/deploy_contracts.py
