# .github/workflows/injective-deploy-contracts.yml

name: Injective Daily Contract Deployment

on:
  schedule:
    - cron: '*/30 * * * *' 
  workflow_dispatch: # Ø¨Ø±Ø§ÛŒ Ø§Ø¬Ø±Ø§ÛŒ Ø¯Ø³ØªÛŒ

jobs:
  deploy-contracts:
    runs-on: ubuntu-latest
    
    env:
      INJECTIVE_PRIVATE_KEY: ${{ secrets.INJECTIVE_PRIVATE_KEY }}

    steps:
      - name: â¬‡ï¸ Checkout Repository
        uses: actions/checkout@v4
        
      - name: ğŸ› ï¸ Setup Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.9' # Ù¾Ø§ÛŒØªÙˆÙ† 3.9 (Ù†Ø³Ø®Ù‡â€ŒØ§ÛŒ Ú©Ù‡ Ù…Ø¹Ù…ÙˆÙ„Ø§ Ø¨Ø§ Ø§Ø¨Ø²Ø§Ø±Ù‡Ø§ÛŒ Ù…Ø®ØªÙ„Ù Ø³Ø§Ø²Ú¯Ø§Ø±Ù‡)

      - name: ğŸ“¦ Install Python Dependencies
        run: pip install -r requirements.txt # web3.py, pytz, python-dotenv Ù†ØµØ¨ Ù…ÛŒØ´Ù†

      # **Ø¬Ø¯ÛŒØ¯ Ùˆ Ù…Ù‡Ù…:** Ù†ØµØ¨ Ú©Ø§Ù…Ù¾Ø§ÛŒÙ„Ø± solc Ø¨Ù‡ ØµÙˆØ±Øª Ù…Ø³ØªÙ‚ÛŒÙ…
      # Ø§ÛŒÙ† Ø§Ú©Ø´Ù† solc Ø±Ùˆ Ø¨Ù‡ PATH Ø³ÛŒØ³ØªÙ… Ø§Ø¶Ø§ÙÙ‡ Ù…ÛŒâ€ŒÚ©Ù†Ù‡.
      - name: ğŸ”§ Install Solidity Compiler (solc)
        uses: actions/setup-node@v4 # Ø§Ø² Ø§ÛŒÙ† Ø§Ú©Ø´Ù† Ø¨Ø±Ø§ÛŒ Ø¯Ø³ØªØ±Ø³ÛŒ Ø¨Ù‡ npm Ùˆ Ù†ØµØ¨ solc Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒÚ©Ù†ÛŒÙ…
        with:
          node-version: '20' # Ù†ÛŒØ§Ø² Ø¨Ù‡ Node.js Ø¨Ø±Ø§ÛŒ Ù†ØµØ¨ solc global
      - run: npm install -g solc@0.8.20 # Ù†ØµØ¨ solc Ù†Ø³Ø®Ù‡ 0.8.20 Ø¨Ù‡ ØµÙˆØ±Øª Ú¯Ù„ÙˆØ¨Ø§Ù„
        
      # **Ù…Ù‡Ù…:** Ù†ØµØ¨ OpenZeppelin Contracts
      # Ø§ÛŒÙ† Ù…Ø±Ø­Ù„Ù‡ Ø¨Ø±Ø§ÛŒ Ø§ÛŒÙ†Ú©Ù‡ solc Ø¨ØªÙˆÙ†Ù‡ @openzeppelin/contracts Ø±Ùˆ Ù¾ÛŒØ¯Ø§ Ú©Ù†Ù‡ØŒ Ø¶Ø±ÙˆØ±ÛŒÙ‡.
      - name: ğŸ“¦ Install OpenZeppelin Contracts (for Solidity imports)
        run: npm install @openzeppelin/contracts
        working-directory: ${{ github.workspace }} # Ø¯Ø± Ø±ÛŒØ´Ù‡ Ø±ÛŒÙ¾Ø§Ø²ÛŒØªÙˆØ±ÛŒ Ù†ØµØ¨ Ø´ÙˆØ¯

      - name: ğŸš€ Run Contract Deployment Script
        run: python scripts/deploy_contracts.py
