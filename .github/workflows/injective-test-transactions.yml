# .github/workflows/injective-test-transactions.yml

name: Injective Manual Test Transactions

on:
  workflow_dispatch: # این به شما امکان می‌دهد تا Workflow را به صورت دستی اجرا کنید

jobs:
  test-transactions:
    runs-on: ubuntu-latest # استفاده از آخرین نسخه اوبونتو
    
    # متغیرهای محیطی که برای اسکریپت Node.js نیاز داریم
    env:
      INJECTIVE_PRIVATE_KEY: ${{ secrets.INJECTIVE_PRIVATE_KEY }} # کلید خصوصی شما از GitHub Secrets

    steps:
      - name: ⬇️ Checkout Repository
        uses: actions/checkout@v4 # برای دسترسی به فایل‌های ریپازیتوری
        
      - name: 🛠️ Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20' # از Node.js نسخه 20 استفاده شود

      - name: 📦 Install Dependencies
        run: npm install # نصب وابستگی‌های تعریف شده در package.json

      - name: 📂 Create data directory if not exists
        run: mkdir -p data # اطمینان از وجود دایرکتوری data
        
      - name: 🚀 Run All Injective Transactions (Test Mode)
        run: |
          # تنظیم متغیرهای محیطی برای اجرای فوری تمام تراکنش‌ها
          # این باعث میشه اسکریپت فکر کنه زمان اجرای همه تراکنش‌ها هست
          # برای تست کامل، پیشنهاد میشه که تمام زمان‌بندی‌های مشخص شده در run-transactions.js رو موقتاً به زمان فعلی یا نزدیک به زمان فعلی تغییر بدید.
          # یا اینکه یک آرگومان به اسکریپت run-transactions.js اضافه کنیم تا حالت تست رو فعال کنه.
          # برای سادگی، فعلا پیشنهاد می‌کنم زمان‌ها رو در اسکریپت run-transactions.js موقتاً تغییر بدید.
          echo "Running transactions in test mode. Please ensure your script's schedules are adjusted for immediate testing or use a dedicated test flag in the script."
          npm start
